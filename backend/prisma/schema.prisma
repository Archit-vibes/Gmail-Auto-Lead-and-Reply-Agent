datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id           Int      @id @default(autoincrement())
  email        String   @unique
  googleID     String   @unique
  refreshToken String
  createdAT    DateTime @default(now())

  emails       Email[]
  activityLogs ActivityLog[]
}

model Email {
  id             Int      @id @default(autoincrement())
  gmailMessageID String   @unique
  threadID       String
  subject        String
  sender         String
  senderDomain   String
  body           String
  receivedAt     DateTime
  processed      Boolean  @default(false)

  userID Int
  user   User @relation(fields: [userID], references: [id])

  lead Lead?
}

model Lead {
  id        Int      @id @default(autoincrement())
  company   String?
  intent    String
  industry  String?
  score     Int
  priority  String
  status    String   @default("new")
  createdAt DateTime @default(now())

  emailId Int   @unique
  email   Email @relation(fields: [emailId], references: [id])

  event Event?
}

model Event {
  id              Int      @id @default(autoincrement())
  calendarEventId String
  scheduledTime   DateTime
  status          String   @default("scheduled")

  leadId Int  @unique
  lead   Lead @relation(fields: [leadId], references: [id])
}

model ActivityLog {
  id        Int      @id @default(autoincrement())
  action    String
  details   Json?
  createdAt DateTime @default(now())

  userId Int
  user   User @relation(fields: [userId], references: [id])
}
